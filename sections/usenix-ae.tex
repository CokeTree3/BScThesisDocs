%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Artifact Appendix Template for Usenix Security'24 AE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Artifact Appendix}
\textit{This artifact appendix is meant to be a self-contained document which
describes a roadmap for the evaluation of your artifact. It should include a
clear description of the hardware, software, and configuration requirements. In
case your artifact aims to receive the functional or results reproduced badge,
it should also include the major claims made by your paper and instructions on
how to reproduce each claim through your artifact. Linking the claims of your
paper to the artifact is a necessary step that ultimately allows artifact
evaluators to reproduce your results.}

\textit{Please fill all the mandatory sections, keeping their titles and
organization but removing the current illustrative content, and remove the
optional sections where those do not apply to your artifact.}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Abstract}
{\em Provide a short description of your artifact.}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Description \& Requirements}

\textit{Both the development and evaluation of the hypervisor detection technique mitigation methods were carried out
on a Microsoft Windows 10 22H2 bare metal system as the host system, with a 10th generation Intel Core\textsuperscript{TM} CPU which supports VT-x hardware virtualization feature.
The virtualized guest system was run on this host using a VMWare Workstation 16 hypervisor with nested virtualization support enabled.
This guest system was used to run HyperDbg's hypervisor and perform all evaluation and testing. Development of the transparency features in HyperDbg was based on its 0.13.0 release version. }

\subsubsection{Security, privacy, and ethical concerns}
\textit{The containerized nature of virtual machines adds a layer of security(cite) to a bare metal system that is used as the host for malware analysis.
During this project, no actual malware samples were tested, only non-malicious parts of them, so full host system safety cannot be guaranteed from this paper.
To be able to run HyperDbg's hypervisor, Windows Driver Signature Enforcement security feature as well as VBS(Virtualization Based Security) must be disabled on the guest system.
This allows the loading of unsigned drivers, which HyperDbg's hypervisor driver is, but it also allows any other process to load their unsafe drivers, 
exposing the system to a much lower level and harder to detect malware attacks. HyperDbg itself, including the features implemented as part of this paper, are open source and available under the GNU GPL v3.0 copyleft license.}

\subsubsection{How to access}
\textit{Access to the developed transparency features is freely available on GitHub, as part of the HyperDbg project~\cite{hyperdbg}. 
The individual commits to intermediate feature implementations are available at: CPUID transparency \href{https://github.com/HyperDbg/HyperDbg/commit/56c2d400fddca22f314c1e5d16cadce6950eb262}{Link}, 
MSR transparency \href{https://github.com/HyperDbg/HyperDbg/commit/2cc3da3daebd793fd56d5c370ef6da398efa6d29}{Link}, Windows system call
transparency \href{https://github.com/HyperDbg/HyperDbg/commit/d0610661baf944259c33e921d3fc265e6a217ad8}{Link}
}


\subsubsection{Hardware dependencies}
\textit{To be able to evaluate the hypervisor transparency features implemented as part of this paper.
The system running the hypervisor driver must have an Intel x64 CPU which supports VT-x and EPT technologies. As of writing this paper, AMD CPUs are not supported.
Both the host and guest systems should also have at least a serial port each that are connected together, this can be a physical connection or a virtual one in case of nested virtualization usage.}

\subsubsection{Software dependencies}
\textit{Both the host and guest systems must be running the 64 bit version of Microsoft Windows operating system,
a certain release version is not specified, but testing was done, and correct operations can only be guaranteed, on Windows 10 and 11.
HyperDbg can be obtained as a compiled software, so no compilation is needed. To be able to load the hypervisor driver of HyperDbg,
Driver Signature Enforcement feature needs to be disabled, one of the methods, and the one that was used during the evaluation section, involves the use of a third party tool WinDbg(link), but this is not required.}

\subsubsection{Benchmarks}
\textit{None}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Set-up}

\textit{For this example evaluation, the nested virtualization approach is chosen, in this case the guest system on which the evaluation will be performed,
is a VMWare Workstation 16 virtual machine running Microsoft Windows 10 22H2. This is assumed to already be set up and in a working state. The precompiled HyperDbg package was used.}

\subsubsection{Installation}
\textit{Instructions to download and install dependencies as
well as the main artifact. After these steps the evaluator should be able to run
a simple functionality test.}

\subsubsection{Basic Test}
\textit{Instructions to run a simple functionality test. Does
not need to run the entire system, but should check that all required software
components are used and functioning fine. Please include the expected successful
output and any required input parameters.}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Evaluation workflow}
{\em [Mandatory for Artifacts Functional \& Results Reproduced, optional for
Artifact Available]} \textit{This section should include all the operational
steps and experiments which must be performed to evaluate if your your artifact is
functional and to validate your paper's key results and claims. For that
purpose, we ask you to use the two following subsections and cross-reference the
items therein as explained next.}

\subsubsection{Major Claims}
{\em [Mandatory for Artifacts Functional \& Results Reproduced, optional for
Artifact Available]} \textit{Enumerate here the major claims (Cx) made in your
paper. Follows an example:}\\

\begin{compactdesc}

    \item[(C1):] \textit{System\_name achieves the same accuracy of the state-of-the-art
    systems for a task X while saving 2x storage resources. This is proven by
    the experiment (E1) described in [refer to your paper's sections] whose
    results are illustrated/reported in [refer to your paper's plots, tables,
    sections or the sort].}

    \item[(C2):] \textit{System\_name has been used to uncover new bugs in the Y
    software. This is proven by the experiments (E2) and (E3) in [ibid].}

\end{compactdesc}

\subsubsection{Experiments}
{\em [Mandatory for Artifacts Functional \& Results Reproduced, optional for
Artifact Available]} \textit{Link explicitly the description of your experiments
to the items you have provided in the previous subsection about Major Claims.
Please provide your estimates of human- and compute-time for each of the listed
experiments (using the suggested hardware/software configuration above). Follows
an example:}

% use paralist for more compact list format: for more details check here:
% https://texfaq.org/FAQ-complist
\begin{compactdesc}

    \item[(E1):] \textit{[Optional Name] [30 human-minutes + 1 compute-hour + 5GB disk]:
    provide a short explanation of the experiment and expected results.}

    \begin{asparadesc}
        \item[How to:]  \textit{Describe thoroughly the steps to perform the
        experiment and to collect and organize the results as expected from your
        paper. We encourage you to use the following structure with three main
        blocks for the description of your experiment.}

        \item[Preparation:] \textit{Describe in this block the steps required to
        prepare and configure the environment for this experiment.}

        \item[Execution:]
        \textit{Describe in this block the steps to run this experiment.}

        \item[Results:] \textit{Describe in this block the steps required to
        collect and interpret the results for this experiment.}
    \end{asparadesc}

    \item[(E2):] \textit{[Optional Name] [1 human-hour + 3 compute-hour]: ...}

    \item[(E3):] \textit{[Optional Name] [1 human-hour + 3 compute-hour]: ...}

\end{compactdesc}

\textit{In all of the above blocks, please provide indications about the
 expected outcome for each of the steps (given the suggested hardware/software
 configuration above).}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Notes on Reusability}
\label{sec:reuse}
\textit{This section is meant to optionally share additional
information on how to use your artifact beyond the research presented in your
paper. In fact, a broader objective of an artifact evaluation is to help you
make your research reusable by others.}

\textit{You can include in this section any sort of instruction that you believe
would help others re-use your artifact, like, for example, scaling down/up
certain components of your artifact, working on different kinds of input or
data-set, customizing the behavior replacing a specific module/algorithm, etc.}
\textit{The hypervisor transparency features developed as part of this paper are only a small portion
of the numerous ways that the presence of hypervisors can be detected. As with most cybersecurity development, 
full security and protection cannot be guaranteed. The development was done in a highly modular and expandable fashion, 
to allow future additions and improvements to hypervisor transparency in HyperDbg, as more mitigation methods are developed and new ways to detect hypervisors are discovered. }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Version}
%%%%%%%%%%%%%%%%%%%%
% Obligatory.
% Do not change/remove.
%%%%%%%%%%%%%%%%%%%%
Based on the LaTeX template for Artifact Evaluation V20231005. Submission,
reviewing and badging methodology followed for the evaluation of this artifact
can be found at \url{https://secartifacts.github.io/usenixsec2024/}.